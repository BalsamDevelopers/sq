
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tirukkural Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .draggable-word {
            cursor: grab;
            user-select: none;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            touch-action: none;
        }
        .draggable-word:active {
            transform: scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .drop-zone {
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
        }
        .drag-over {
            background-color: #e0e7ff;
            border-color: #4f46e5;
        }
        .success-message {
            color: #10b981;
        }
        .error-message {
            color: #ef4444;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white rounded-3xl shadow-2xl p-6 sm:p-10 w-full max-w-2xl text-center">

        <div id="start-page" class="">
            <h1 class="text-4xl sm:text-5xl font-bold text-gray-800 mb-2">திருக்குறள் விளையாட்டு</h1>
            <p class="text-lg text-gray-600 mb-8">A game to learn and appreciate Tirukkural.</p>
            <p class="text-xl font-semibold mb-4 text-gray-700">Select a Level to begin:</p>

            <div class="flex justify-center space-x-4 mb-8">
                <button id="start-level1-btn" class="px-6 py-3 rounded-full font-semibold text-lg transition-all duration-300 transform hover:scale-105 bg-indigo-600 text-white shadow-lg">Level 1</button>
                <button id="start-level2-btn" class="px-6 py-3 rounded-full font-semibold text-lg transition-all duration-300 transform hover:scale-105 bg-gray-300 text-gray-800">Level 2</button>
            </div>

            <button id="start-game-btn" class="px-8 py-4 rounded-full font-bold text-white bg-green-500 transition-all duration-300 hover:bg-green-600 transform hover:scale-105 shadow-md">Start Game</button>
        </div>

        <div id="game-ui" class="hidden">
            <h1 class="text-4xl sm:text-5xl font-bold text-gray-800 mb-2">திருக்குறள்</h1>
            <p id="current-level-display" class="text-lg text-gray-600 mb-8"></p>

            <div id="level1-container" class="level-container hidden">
                <div id="word-jumble" class="flex flex-wrap justify-center gap-4 mb-6"></div>
                <div id="word-order" class="flex flex-wrap justify-center gap-4 mb-8 p-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300"></div>
                <div class="flex justify-center space-x-4">
                     <button id="check-btn-level1" class="px-8 py-4 rounded-full font-bold text-white bg-green-500 transition-all duration-300 hover:bg-green-600 transform hover:scale-105 shadow-md">Check</button>
                     <button id="show-answer-btn-level1" class="px-8 py-4 rounded-full font-bold text-white bg-blue-500 transition-all duration-300 hover:bg-blue-600 transform hover:scale-105 shadow-md">Show Answer</button>
                </div>
                <p id="kural-answer-level1" class="text-2xl sm:text-3xl font-semibold text-gray-700 mt-6 hidden"></p>
            </div>

            <div id="level2-container" class="level-container hidden">
                <p id="kural-text-level2" class="text-2xl sm:text-3xl text-gray-700 mb-6 text-left leading-relaxed"></p>
                <div id="options-container" class="flex flex-wrap justify-center gap-4 mb-8"></div>
                <div class="flex justify-center space-x-4">
                    <button id="check-btn-level2" class="px-8 py-4 rounded-full font-bold text-white bg-green-500 transition-all duration-300 hover:bg-green-600 transform hover:scale-105 shadow-md">Check</button>
                    <button id="show-answer-btn-level2" class="px-8 py-4 rounded-full font-bold text-white bg-blue-500 transition-all duration-300 hover:bg-blue-600 transform hover:scale-105 shadow-md">Show Answer</button>
                </div>
                <p id="kural-answer-level2" class="text-2xl sm:text-3xl font-semibold text-gray-700 mt-6 hidden"></p>
            </div>

            <div id="game-message" class="mt-8 text-xl font-semibold p-4 rounded-lg"></div>
        </div>
    </div>

    <script>
        // Data for Tirukkural verses
        const tirukkurals = [
            {
                text: "அகர முதல எழுத்தெல்லாம் ஆதி<br>பகவன் முதற்றே உலகு.",
                words: ["அகர", "முதல", "எழுத்தெல்லாம்", "ஆதி", "பகவன்", "முதற்றே", "உலகு"]
            },
            {
                text: "கற்றதனால் ஆய பயனென்கொல் வாலறிவன்<br>நற்றாள் தொழாஅர் எனின்.",
                words: ["கற்றதனால்", "ஆய", "பயனென்கொல்", "வாலறிவன்", "நற்றாள்", "தொழாஅர்", "எனின்"]
            },
            {
                text: "மலர்மிசை யேகினான் மாணடி சேர்ந்தார்<br>நிலமிசை நீடுவாழ் வார்.",
                words: ["மலர்மிசை", "யேகினான்", "மாணடி", "சேர்ந்தார்", "நிலமிசை", "நீடுவாழ்", "வார்"]
            },
            {
                text: "வெறுப்புடமை யிந்தனன் வேண்டின் அருள்செய்<br>மறப்புடமை யில்லா அடியார்தம்.",
                words: ["வெறுப்புடமை", "யிந்தனன்", "வேண்டின்", "அருள்செய்", "மறப்புடமை", "யில்லா", "அடியார்தம்"]
            }
        ];

        let currentKural = null;
        let selectedLevel = 1;

        const startPage = document.getElementById('start-page');
        const gameUi = document.getElementById('game-ui');
        const startLevel1Btn = document.getElementById('start-level1-btn');
        const startLevel2Btn = document.getElementById('start-level2-btn');
        const startGameBtn = document.getElementById('start-game-btn');
        const currentLevelDisplay = document.getElementById('current-level-display');
        
        const level1Container = document.getElementById('level1-container');
        const level2Container = document.getElementById('level2-container');
        const wordJumble = document.getElementById('word-jumble');
        const wordOrder = document.getElementById('word-order');
        const checkBtnLevel1 = document.getElementById('check-btn-level1');
        const showAnswerBtnLevel1 = document.getElementById('show-answer-btn-level1');
        const kuralAnswerLevel1 = document.getElementById('kural-answer-level1');
        const kuralTextLevel2 = document.getElementById('kural-text-level2');
        const optionsContainer = document.getElementById('options-container');
        const checkBtnLevel2 = document.getElementById('check-btn-level2');
        const showAnswerBtnLevel2 = document.getElementById('show-answer-btn-level2');
        const kuralAnswerLevel2 = document.getElementById('kural-answer-level2');
        const gameMessage = document.getElementById('game-message');

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function selectLevel(level) {
            selectedLevel = level;
            startLevel1Btn.classList.remove('bg-indigo-600', 'text-white', 'shadow-lg');
            startLevel2Btn.classList.remove('bg-indigo-600', 'text-white', 'shadow-lg');
            startLevel1Btn.classList.add('bg-gray-300', 'text-gray-800');
            startLevel2Btn.classList.add('bg-gray-300', 'text-gray-800');

            if (level === 1) {
                startLevel1Btn.classList.remove('bg-gray-300', 'text-gray-800');
                startLevel1Btn.classList.add('bg-indigo-600', 'text-white', 'shadow-lg');
            } else {
                startLevel2Btn.classList.remove('bg-gray-300', 'text-gray-800');
                startLevel2Btn.classList.add('bg-indigo-600', 'text-white', 'shadow-lg');
            }
        }

        function startGame() {
            startPage.classList.add('hidden');
            gameUi.classList.remove('hidden');
            gameMessage.textContent = '';
            gameMessage.classList.remove('success-message', 'error-message', 'bg-red-100', 'bg-green-100');
            
            if (selectedLevel === 1) {
                currentLevelDisplay.textContent = "Level 1: Jumbled Words";
                loadLevel1();
            } else {
                currentLevelDisplay.textContent = "Level 2: Fill in the Blanks";
                loadLevel2();
            }
        }

        function loadLevel1() {
            level1Container.classList.remove('hidden');
            level2Container.classList.add('hidden');
            wordJumble.innerHTML = '';
            wordOrder.innerHTML = '';
            kuralAnswerLevel1.classList.add('hidden');
            showAnswerBtnLevel1.disabled = false;
            
            currentKural = tirukkurals[Math.floor(Math.random() * tirukkurals.length)];
            
            const jumbledWords = shuffleArray([...currentKural.words]);

            jumbledWords.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.textContent = word;
                wordDiv.className = 'draggable-word bg-indigo-500 text-white rounded-md px-4 py-2 text-xl font-medium shadow-md';
                wordDiv.draggable = true;
                wordDiv.dataset.word = word;
                wordJumble.appendChild(wordDiv);
            });

            currentKural.words.forEach(() => {
                const dropZone = document.createElement('div');
                // Removed fixed width (w-24) to allow dynamic sizing
                dropZone.className = 'drop-zone h-12 flex-grow flex items-center justify-center border-2 border-dashed border-gray-400 rounded-md';
                wordOrder.appendChild(dropZone);
            });

            wordJumble.addEventListener('dragstart', handleDragStart);
            wordOrder.addEventListener('dragover', handleDragOver);
            wordOrder.addEventListener('drop', handleDrop);
            wordOrder.addEventListener('dragleave', handleDragLeave);
        }

        function loadLevel2() {
            level2Container.classList.remove('hidden');
            level1Container.classList.add('hidden');
            kuralTextLevel2.innerHTML = '';
            optionsContainer.innerHTML = '';
            kuralAnswerLevel2.classList.add('hidden');
            showAnswerBtnLevel2.disabled = false;
            
            currentKural = tirukkurals[Math.floor(Math.random() * tirukkurals.length)];
            
            const lines = currentKural.text.split('<br>');
            
            const blanks = [];
            
            lines.forEach((line, lineIndex) => {
                const words = line.trim().split(' ');
                const blankIndex = Math.floor(Math.random() * words.length);
                const blankWord = words[blankIndex];
                
                words[blankIndex] = `<span class="blank-spot inline-block w-24 h-8 border-b-2 border-gray-400 mx-1 align-bottom text-center text-xl" data-line-index="${lineIndex}"></span>`;
                blanks.push({ lineIndex, word: blankWord });
                
                const lineDiv = document.createElement('p');
                lineDiv.className = 'mb-4';
                lineDiv.innerHTML = words.join(' ');
                kuralTextLevel2.appendChild(lineDiv);
            });

            const allWords = [...new Set(tirukkurals.flatMap(k => k.words))];
            
            blanks.forEach((blank, index) => {
                const correct = blank.word;
                const incorrect = shuffleArray(allWords.filter(w => w !== correct)).slice(0, 2);
                const options = shuffleArray([correct, ...incorrect]);
                
                options.forEach(option => {
                    const optionBtn = document.createElement('button');
                    optionBtn.textContent = option;
                    optionBtn.className = 'option-btn px-4 py-2 rounded-full font-semibold bg-gray-300 text-gray-800 transition-colors hover:bg-indigo-200';
                    optionBtn.addEventListener('click', () => {
                        const blankSpot = kuralTextLevel2.querySelector(`[data-line-index="${index}"]`);
                        if (blankSpot) {
                            blankSpot.textContent = option;
                            optionBtn.disabled = true;
                        }
                    });
                    optionsContainer.appendChild(optionBtn);
                });
            });
        }

        function checkLevel1() {
            const placedWords = Array.from(wordOrder.children).map(zone => zone.textContent.trim());
            const correctOrder = currentKural.words;
            const isCorrect = JSON.stringify(placedWords) === JSON.stringify(correctOrder);

            if (isCorrect) {
                displayMessage("Correct! Well done.", true);
            } else {
                displayMessage("Incorrect. Try again!", false);
            }
        }

        function checkLevel2() {
            const blankSpots = kuralTextLevel2.querySelectorAll('.blank-spot');
            let allCorrect = true;
            
            blankSpots.forEach((spot, index) => {
                const filledWord = spot.textContent.trim();
                const correctWord = blanks[index].word;
                if (filledWord !== correctWord) {
                    allCorrect = false;
                    spot.classList.add('text-red-500');
                } else {
                     spot.classList.add('text-green-600');
                }
            });

            if (allCorrect) {
                displayMessage("Correct! You have filled all the blanks correctly.", true);
            } else {
                displayMessage("Incorrect. Some words are wrong. Try again!", false);
            }
        }
        
        function showAnswer(level) {
            let answerElement;
            let answerText;
            if (level === 1) {
                answerElement = kuralAnswerLevel1;
                answerText = currentKural.text;
                showAnswerBtnLevel1.disabled = true;
            } else {
                answerElement = kuralAnswerLevel2;
                answerText = currentKural.text;
                showAnswerBtnLevel2.disabled = true;
            }
            answerElement.innerHTML = answerText;
            answerElement.classList.remove('hidden');
        }


        function displayMessage(message, isSuccess) {
            gameMessage.textContent = message;
            gameMessage.classList.remove('success-message', 'error-message', 'bg-red-100', 'bg-green-100');
            if (isSuccess) {
                gameMessage.classList.add('success-message', 'bg-green-100');
            } else {
                gameMessage.classList.add('error-message', 'bg-red-100');
            }
        }

        // Drag and Drop event handlers
        let dragged = null;
        function handleDragStart(e) {
            dragged = e.target;
            e.dataTransfer.setData('text/plain', dragged.dataset.word);
            dragged.style.opacity = '0.5';
        }

        function handleDragOver(e) {
            e.preventDefault();
            // Ensure the drop zone is empty before allowing a drop
            if (e.target.classList.contains('drop-zone') && e.target.textContent.trim() === '') {
                e.target.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            e.target.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.target;
            dropZone.classList.remove('drag-over');

            // Only drop if the target is an empty drop zone
            if (dropZone.classList.contains('drop-zone') && dropZone.textContent.trim() === '') {
                dropZone.textContent = dragged.dataset.word;
                // Remove fixed height to allow text to wrap
                dropZone.classList.remove('h-12', 'flex-grow', 'border-dashed', 'border-gray-400');
                // Apply styling for the placed word
                dropZone.classList.add('bg-indigo-200', 'text-gray-800', 'font-semibold', 'rounded-md', 'px-4', 'py-2', 'whitespace-nowrap');
                dragged.remove();
            }
        }

        // Event Listeners
        startLevel1Btn.addEventListener('click', () => selectLevel(1));
        startLevel2Btn.addEventListener('click', () => selectLevel(2));
        startGameBtn.addEventListener('click', startGame);
        checkBtnLevel1.addEventListener('click', checkLevel1);
        checkBtnLevel2.addEventListener('click', checkLevel2);
        showAnswerBtnLevel1.addEventListener('click', () => showAnswer(1));
        showAnswerBtnLevel2.addEventListener('click', () => showAnswer(2));

        // Initial state
        window.onload = () => selectLevel(1);
    </script>
</body>
</html>
