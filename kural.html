<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tirukkural Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .draggable-word {
            cursor: grab;
            user-select: none;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            touch-action: none;
        }
        .draggable-word:active {
            transform: scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .drop-zone {
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
            border-bottom: 2px dashed #9ca3af;
        }
        .drag-over {
            background-color: #e0e7ff;
            border-color: #4f46e5;
        }
        .success-message {
            color: #10b981;
        }
        .error-message {
            color: #ef4444;
        }
        .draggable-placeholder {
            min-width: 6rem;
            min-height: 2.5rem;
        }
        .blank-spot {
            min-width: 7rem;
            height: 2.5rem;
            display: inline-block;
            vertical-align: middle;
        }
        .blank-spot > .draggable-word {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .level2-text-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-end;
            line-height: 2.5rem;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="bg-white rounded-3xl shadow-2xl p-6 sm:p-10 w-full max-w-2xl text-center">
        <div id="start-page" class="">
            <h1 class="text-4xl sm:text-5xl font-bold text-gray-800 mb-2">திருக்குறள் விளையாட்டு</h1>
            <p class="text-lg text-gray-600 mb-8">A game to learn and appreciate Tirukkural.</p>
            <p class="text-xl font-semibold mb-4 text-gray-700">Select a Level to begin:</p>
            <div class="flex justify-center space-x-4 mb-8">
                <button id="start-level1-btn" class="px-6 py-3 rounded-full font-semibold text-lg transition-all duration-300 transform hover:scale-105 bg-indigo-600 text-white shadow-lg">Level 1</button>
                <button id="start-level2-btn" class="px-6 py-3 rounded-full font-semibold text-lg transition-all duration-300 transform hover:scale-105 bg-gray-300 text-gray-800">Level 2</button>
            </div>
            <button id="start-game-btn" class="px-8 py-4 rounded-full font-bold text-white bg-green-500 transition-all duration-300 hover:bg-green-600 transform hover:scale-105 shadow-md">Start Game</button>
        </div>
        <div id="game-ui" class="hidden">
            <h1 class="text-4xl sm:text-5xl font-bold text-gray-800 mb-2">திருக்குறள்</h1>
            <p id="current-level-display" class="text-lg text-gray-600 mb-8"></p>
            <div id="level1-container" class="level-container hidden">
                <div id="word-jumble" class="flex flex-wrap justify-center gap-4 mb-6 p-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300"></div>
                <div id="drop-zone-rows" class="flex flex-col gap-4">
                    <div id="word-order-row1" class="flex flex-wrap justify-center gap-4 p-4 bg-white rounded-lg border-2 border-dashed border-gray-300"></div>
                    <div id="word-order-row2" class="flex flex-wrap justify-center gap-4 p-4 bg-white rounded-lg border-2 border-dashed border-gray-300"></div>
                </div>
                <div class="flex justify-center space-x-4 mt-8">
                    <button id="check-btn-level1" class="px-8 py-4 rounded-full font-bold text-white bg-green-500 transition-all duration-300 hover:bg-green-600 transform hover:scale-105 shadow-md">Check</button>
                    <button id="show-answer-btn-level1" class="px-8 py-4 rounded-full font-bold text-white bg-blue-500 transition-all duration-300 hover:bg-blue-600 transform hover:scale-105 shadow-md">Show Answer</button>
                    <button id="next-btn-level1" class="px-8 py-4 rounded-full font-bold text-white bg-gray-500 transition-all duration-300 hover:bg-gray-600 transform hover:scale-105 shadow-md hidden">அடுத்த</button>
                </div>
                <p id="kural-answer-level1" class="text-2xl sm:text-3xl font-semibold text-gray-700 mt-6 hidden"></p>
            </div>
            <div id="level2-container" class="level-container hidden">
                <p id="kural-text-level2" class="text-2xl sm:text-3xl text-gray-700 mb-6 text-left leading-relaxed level2-text-container"></p>
                <div id="word-jumble-level2" class="flex flex-wrap justify-center gap-4 mb-8 p-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300"></div>
                <div class="flex justify-center space-x-4">
                    <button id="check-btn-level2" class="px-8 py-4 rounded-full font-bold text-white bg-green-500 transition-all duration-300 hover:bg-green-600 transform hover:scale-105 shadow-md">Check</button>
                    <button id="show-answer-btn-level2" class="px-8 py-4 rounded-full font-bold text-white bg-blue-500 transition-all duration-300 hover:bg-blue-600 transform hover:scale-105 shadow-md">Show Answer</button>
                    <button id="next-btn-level2" class="px-8 py-4 rounded-full font-bold text-white bg-gray-500 transition-all duration-300 hover:bg-gray-600 transform hover:scale-105 shadow-md hidden">அடுத்த</button>
                </div>
                <p id="kural-answer-level2" class="text-2xl sm:text-3xl font-semibold text-gray-700 mt-6 hidden"></p>
            </div>
            <div id="game-message" class="mt-8 text-xl font-semibold p-4 rounded-lg"></div>
        </div>
    </div>
        <script>
        // Data for Tirukkural verses
        const tirukkurals = [
            {
                text: "அகர முதல எழுத்தெல்லாம் ஆதி<br>பகவன் முதற்றே உலகு.",
                words: ["அகர", "முதல", "எழுத்தெல்லாம்", "ஆதி", "பகவன்", "முதற்றே", "உலகு"]
            },
            {
                text: "கற்றதனால் ஆய பயனென்கொல் வாலறிவன்<br>நற்றாள் தொழாஅர் எனின்.",
                words: ["கற்றதனால்", "ஆய", "பயனென்கொல்", "வாலறிவன்", "நற்றாள்", "தொழாஅர்", "எனின்"]
            },
            {
                text: "மலர்மிசை யேகினான் மாணடி சேர்ந்தார்<br>நிலமிசை நீடுவாழ் வார்.",
                words: ["மலர்மிசை", "யேகினான்", "மாணடி", "சேர்ந்தார்", "நிலமிசை", "நீடுவாழ்", "வார்"]
            },
            {
                text: "வெறுப்புடமை யிந்தனன் வேண்டின் அருள்செய்<br>மறப்புடமை யில்லா அடியார்தம்.",
                words: ["வெறுப்புடமை", "யிந்தனன்", "வேண்டின்", "அருள்செய்", "மறப்புடமை", "யில்லா", "அடியார்தம்"]
            }
        ];

        let currentKural = null;
        let selectedLevel = 1;
        let level2Blanks = [];
        let dragged = null;

        const startPage = document.getElementById('start-page');
        const gameUi = document.getElementById('game-ui');
        const startLevel1Btn = document.getElementById('start-level1-btn');
        const startLevel2Btn = document.getElementById('start-level2-btn');
        const startGameBtn = document.getElementById('start-game-btn');
        const currentLevelDisplay = document.getElementById('current-level-display');

        const level1Container = document.getElementById('level1-container');
        const wordJumble = document.getElementById('word-jumble');
        const wordOrderRow1 = document.getElementById('word-order-row1');
        const wordOrderRow2 = document.getElementById('word-order-row2');
        const checkBtnLevel1 = document.getElementById('check-btn-level1');
        const showAnswerBtnLevel1 = document.getElementById('show-answer-btn-level1');
        const kuralAnswerLevel1 = document.getElementById('kural-answer-level1');
        const nextBtnLevel1 = document.getElementById('next-btn-level1');

        const level2Container = document.getElementById('level2-container');
        const kuralTextLevel2 = document.getElementById('kural-text-level2');
        const wordJumbleLevel2 = document.getElementById('word-jumble-level2');
        const checkBtnLevel2 = document.getElementById('check-btn-level2');
        const showAnswerBtnLevel2 = document.getElementById('show-answer-btn-level2');
        const kuralAnswerLevel2 = document.getElementById('kural-answer-level2');
        const nextBtnLevel2 = document.getElementById('next-btn-level2');
        const gameMessage = document.getElementById('game-message');

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function selectLevel(level) {
            selectedLevel = level;
            startLevel1Btn.classList.remove('bg-indigo-600', 'text-white', 'shadow-lg');
            startLevel2Btn.classList.remove('bg-indigo-600', 'text-white', 'shadow-lg');
            startLevel1Btn.classList.add('bg-gray-300', 'text-gray-800');
            startLevel2Btn.classList.add('bg-gray-300', 'text-gray-800');

            if (level === 1) {
                startLevel1Btn.classList.remove('bg-gray-300', 'text-gray-800');
                startLevel1Btn.classList.add('bg-indigo-600', 'text-white', 'shadow-lg');
            } else {
                startLevel2Btn.classList.remove('bg-gray-300', 'text-gray-800');
                startLevel2Btn.classList.add('bg-indigo-600', 'text-white', 'shadow-lg');
            }
        }

        function startGame() {
            startPage.classList.add('hidden');
            gameUi.classList.remove('hidden');
            gameMessage.textContent = '';
            gameMessage.classList.remove('success-message', 'error-message', 'bg-red-100', 'bg-green-100');
            loadNextKural();
        }

        function loadNextKural() {
            if (selectedLevel === 1) {
                currentLevelDisplay.textContent = "Level 1: Jumbled Words";
                loadLevel1();
                nextBtnLevel1.classList.add('hidden');
            } else {
                currentLevelDisplay.textContent = "Level 2: Fill in the Blanks";
                loadLevel2();
                nextBtnLevel2.classList.add('hidden');
            }
            gameMessage.textContent = '';
            kuralAnswerLevel1.classList.add('hidden');
            kuralAnswerLevel2.classList.add('hidden');
        }

        function loadLevel1() {
            level1Container.classList.remove('hidden');
            level2Container.classList.add('hidden');
            wordJumble.innerHTML = '';
            wordOrderRow1.innerHTML = '';
            wordOrderRow2.innerHTML = '';
            kuralAnswerLevel1.classList.add('hidden');
            showAnswerBtnLevel1.disabled = false;

            currentKural = tirukkurals[Math.floor(Math.random() * tirukkurals.length)];
            const jumbledWords = shuffleArray([...currentKural.words]);

            jumbledWords.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.textContent = word;
                wordDiv.className = 'draggable-word bg-indigo-500 text-white rounded-md px-4 py-2 text-xl font-medium shadow-md';
                wordDiv.draggable = true;
                wordDiv.dataset.word = word;
                wordJumble.appendChild(wordDiv);
            });

            for (let i = 0; i < 4; i++) {
                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone draggable-placeholder flex-1 flex items-center justify-center border-2 border-dashed border-gray-400 rounded-md';
                wordOrderRow1.appendChild(dropZone);
            }

            for (let i = 0; i < 3; i++) {
                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone draggable-placeholder flex-1 flex items-center justify-center border-2 border-dashed border-gray-400 rounded-md';
                wordOrderRow2.appendChild(dropZone);
            }
            
            // Add drag and drop listeners
            wordJumble.addEventListener('dragstart', handleDragStart);
            wordOrderRow1.addEventListener('dragover', handleDragOver);
            wordOrderRow1.addEventListener('drop', handleDrop);
            wordOrderRow1.addEventListener('dragleave', handleDragLeave);
            wordOrderRow2.addEventListener('dragover', handleDragOver);
            wordOrderRow2.addEventListener('drop', handleDrop);
            wordOrderRow2.addEventListener('dragleave', handleDragLeave);
        }

        function loadLevel2() {
            level2Container.classList.remove('hidden');
            level1Container.classList.add('hidden');
            kuralTextLevel2.innerHTML = '';
            wordJumbleLevel2.innerHTML = '';
            kuralAnswerLevel2.classList.add('hidden');
            showAnswerBtnLevel2.disabled = false;
            level2Blanks = [];

            currentKural = tirukkurals[Math.floor(Math.random() * tirukkurals.length)];
            const kuralWords = currentKural.words;
            const blankWords = [];

            const indicesToBlank = new Set();
            while (indicesToBlank.size < 2) {
                indicesToBlank.add(Math.floor(Math.random() * kuralWords.length));
            }

            let kuralHtml = '';
            kuralWords.forEach((word, index) => {
                if (indicesToBlank.has(index)) {
                    const dropZoneHtml = `<div class="blank-spot drop-zone inline-block border-b-2 border-gray-400 mx-1 min-w-[7rem]"></div>`;
                    kuralHtml += dropZoneHtml + ' ';
                    blankWords.push(word);
                } else {
                    kuralHtml += `<span>${word}</span> `;
                }
            });

            kuralHtml = kuralHtml.replace(/<br>/g, '<br>');
            level2Blanks = blankWords;
            kuralTextLevel2.innerHTML = kuralHtml;

            const allWords = [...new Set(tirukkurals.flatMap(k => k.words))];
            const incorrectWords = shuffleArray(allWords.filter(w => !blankWords.includes(w))).slice(0, 2);
            const options = shuffleArray([...blankWords, ...incorrectWords]);

            options.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.textContent = word;
                wordDiv.className = 'draggable-word bg-indigo-500 text-white rounded-md px-4 py-2 text-xl font-medium shadow-md';
                wordDiv.draggable = true;
                wordDiv.dataset.word = word;
                wordJumbleLevel2.appendChild(wordDiv);
            });

            wordJumbleLevel2.addEventListener('dragstart', handleDragStart);
            const dropZones = document.querySelectorAll('#kural-text-level2 .drop-zone');
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('dragleave', handleDragLeave);
            });
        }

        function checkLevel1() {
            const placedWords = [];
            const allDropZones = Array.from(wordOrderRow1.children).concat(Array.from(wordOrderRow2.children));
            allDropZones.forEach(zone => {
                const wordElement = zone.querySelector('.draggable-word');
                if (wordElement) {
                    placedWords.push(wordElement.dataset.word);
                } else {
                    placedWords.push('');
                }
            });

            const correctOrder = currentKural.words;
            const isCorrect = JSON.stringify(placedWords) === JSON.stringify(correctOrder);

            if (isCorrect) {
                displayMessage("Correct! Well done.", true);
                nextBtnLevel1.classList.remove('hidden');
            } else {
                displayMessage("Incorrect. Try again!", false);
            }
        }

        function checkLevel2() {
            const blankSpots = document.querySelectorAll('#kural-text-level2 .drop-zone');
            let allCorrect = true;

            blankSpots.forEach((spot, index) => {
                const filledWordElement = spot.querySelector('.draggable-word');
                const filledWord = filledWordElement ? filledWordElement.dataset.word : '';
                const correctWord = level2Blanks[index];

                spot.classList.remove('text-red-500', 'text-green-600');
                if (filledWord !== correctWord) {
                    allCorrect = false;
                    spot.classList.add('text-red-500');
                } else {
                    spot.classList.add('text-green-600');
                }
            });

            if (allCorrect) {
                displayMessage("Correct! You have filled all the blanks correctly.", true);
                nextBtnLevel2.classList.remove('hidden');
            } else {
                displayMessage("Incorrect. Some words are wrong. Try again!", false);
            }
        }

        function showAnswer(level) {
            let answerElement;
            let answerText;
            if (level === 1) {
                answerElement = kuralAnswerLevel1;
                answerText = currentKural.text;
                showAnswerBtnLevel1.disabled = true;
                nextBtnLevel1.classList.remove('hidden');
            } else {
                answerElement = kuralAnswerLevel2;
                answerText = currentKural.text;
                showAnswerBtnLevel2.disabled = true;
                nextBtnLevel2.classList.remove('hidden');
            }
            answerElement.innerHTML = answerText;
            answerElement.classList.remove('hidden');
        }

        function displayMessage(message, isSuccess) {
            gameMessage.textContent = message;
            gameMessage.classList.remove('success-message', 'error-message', 'bg-red-100', 'bg-green-100');
            if (isSuccess) {
                gameMessage.classList.add('success-message', 'bg-green-100');
            } else {
                gameMessage.classList.add('error-message', 'bg-red-100');
            }
        }

        // Drag and Drop event handlers
        function handleDragStart(e) {
            dragged = e.target;
            e.dataTransfer.setData('text/plain', dragged.dataset.word);
            setTimeout(() => {
                dragged.style.opacity = '0.5';
            }, 0);
        }

        function handleDragOver(e) {
            e.preventDefault();
            const target = e.target.closest('.drop-zone');
            if (target && target.children.length === 0) {
                target.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            const target = e.target.closest('.drop-zone');
            if (target) {
                target.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.target.closest('.drop-zone');

            if (dropZone && dropZone.children.length === 0) {
                dropZone.classList.remove('drag-over');
                dropZone.classList.add('bg-indigo-200', 'text-gray-800', 'font-semibold', 'rounded-md', 'px-4', 'py-2', 'whitespace-nowrap');
                dropZone.appendChild(dragged);
                dragged.style.opacity = '1';
                dragged = null;
            } else if (dropZone) {
                dropZone.classList.remove('drag-over');
            }
        }

        // Event Listeners
        startLevel1Btn.addEventListener('click', () => selectLevel(1));
        startLevel2Btn.addEventListener('click', () => selectLevel(2));
        startGameBtn.addEventListener('click', startGame);
        checkBtnLevel1.addEventListener('click', checkLevel1);
        checkBtnLevel2.addEventListener('click', checkLevel2);
        showAnswerBtnLevel1.addEventListener('click', () => showAnswer(1));
        showAnswerBtnLevel2.addEventListener('click', () => showAnswer(2));
        nextBtnLevel1.addEventListener('click', loadNextKural);
        nextBtnLevel2.addEventListener('click', loadNextKural);

        // Initial state
        window.onload = () => selectLevel(1);
    </script>
</body>
</html>
